<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recruitment Flow Form</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f7f5f4;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    min-height: 100vh;
  }

  .form-flow {
    width: 1400px;
    max-width: 1400px;
    background: #fff;
    border-radius: 12px;
    padding: 30px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }

  .form-flow h2 {
    background: #6a86dc;
    color: white;
    text-align: center;
    padding: 15px;
    border-radius: 10px;
    font-size: 1.5rem;
    margin: 0 0 20px 0;
  }

  .sections-container {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
    align-items: start;
  }

  .section {
    border: 2px solid #000;
    border-radius: 10px;
    padding: 20px;
    background-color: #fafafa;
    height: fit-content;
  }

  .section h3 {
    margin-top: 0;
    font-size: 1rem;
    border-bottom: 2px solid #6a86dc;
    padding-bottom: 8px;
    margin-bottom: 15px;
    color: #333;
  }

  label {
    display: block;
    margin-top: 12px;
    font-weight: 600;
    font-size: 0.95rem;
    color: #333;
  }

  input, select, textarea {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 0.9rem;
    box-sizing: border-box;
  }

  textarea {
    resize: vertical;
    min-height: 60px;
  }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border: 2px solid #6a86dc;
    box-shadow: 0 0 5px rgba(106, 134, 220, 0.3);
  }

  .button-container {
    grid-column: 1 / -1;
    text-align: center;
    margin-top: 20px;
  }

  button {
    padding: 12px 40px;
    border: none;
    border-radius: 8px;
    background-color: #d86dd8;
    color: white;
    font-weight: bold;
    cursor: pointer;
    font-size: 1rem;
  }

  button:hover {
    background-color: #b84bb8;
    transform: scale(1.05);
    transition: all 0.3s ease;
  }

  .success {
    background-color: #d4edda;
    color: #155724;
    padding: 12px;
    border-radius: 8px;
    margin-top: 20px;
    text-align: center;
    font-weight: bold;
    grid-column: 1 / -1;
  }

  .error {
    background-color: #f8d7da;
    color: #721c24;
    padding: 12px;
    border-radius: 8px;
    margin-top: 20px;
    text-align: center;
    font-weight: bold;
    grid-column: 1 / -1;
  }

  .hidden {
    display: none;
  }

  @media (max-width: 1200px) {
    .form-flow {
      width: 100%;
    }
    
    .sections-container {
      grid-template-columns: 1fr 1fr;
    }
  }

  @media (max-width: 768px) {
    .sections-container {
      grid-template-columns: 1fr;
    }
  }
</style>
</head>
<body>
  <form class="form-flow" id="recruitmentForm">
    <h2>OPEN POSITION</h2>

    <div class="sections-container">
      
      <div class="section">
        <h3>1. New Requirement</h3>
        
        <label>Department</label>
        <input type="text" name="department" placeholder="Enter department name" required>

        <label>Position Title</label>
        <input type="text" name="position" placeholder="Enter job title" required>

        <label>HR Department Email</label>
        <input type="email" name="hr_email" placeholder="Enter HR department email" required>

        <label>CBO Email</label>
        <input type="email" name="cbo_email" placeholder="Enter CBO email" required>

        <label>Experience</label>
        <input type="number" name="experience" placeholder="Number of Years Experience" min="0" required>

        <label>Salary Range</label>
        <select name="salary">
          <option value="">-- Select Range --</option>
          <option value="1-3 lakh">1-3 lakh</option>
          <option value="4-5 lakh">4-5 lakh</option>
          <option value="5-7 lakh">5-7 lakh</option>
          <option value="7-10 lakh">7-10 lakh</option>
        </select>

        <label>Languages Required</label>
        <input type="text" name="Languages" placeholder="Languages known" required>

        <label>Requirement Closer Date</label>
        <input type="datetime-local" name="datetime" placeholder="Select date and time" required>

        <label>Remarks</label>
        <textarea name="reason" placeholder="Remarks"></textarea>
      </div>

      <div class="section">
        <h3>2. JD Creation</h3>
        <label>Job Description *</label>
        <textarea name="jd" placeholder="Write or paste job description here" style="min-height: 100px;" required></textarea>

        <label>Required Skills</label>
        <input type="text" name="skills" placeholder="e.g. Networking, React.js, SQL">
      </div>

      <div class="section">
        <h3>3. Replacement</h3>

        <label>Number Of Vacancy</label>
        <input type="number" name="numberofvacancy" placeholder="Enter Number Of Vacancy" min="1" required>

        <label>Is this a replacement for an existing employee? *</label>
        <select name="replacement" id="replacementSelect" required>
          <option value="">-- Select --</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>

        <div id="replacementYesFields" class="hidden">
          <label>Employee Name</label>
          <input type="text" id="employeeName" placeholder="Enter previous employee name">
        </div>

        <div id="replacementNoFields" class="hidden">
          <label>Reason for Hiring *</label>
          <textarea id="hiringReason" placeholder="Explain the reason for this new hire" style="min-height: 80px;"></textarea>
        </div>
      </div>

      <div class="button-container">
        <button type="submit">Submit Form</button>
      </div>

      <div id="responseMsg"></div>

    </div>
  </form>

  <script>
    const form = document.getElementById("recruitmentForm");
    const responseMsg = document.getElementById("responseMsg");
    const replacementSelect = document.getElementById("replacementSelect");
    const replacementYesFields = document.getElementById("replacementYesFields");
    const replacementNoFields = document.getElementById("replacementNoFields");
    const employeeName = document.getElementById("employeeName");
    const hiringReason = document.getElementById("hiringReason");

    // Show/hide fields based on replacement selection
    replacementSelect.addEventListener("change", function() {
      const value = this.value;
      
      if (value === "Yes") {
        replacementYesFields.classList.remove("hidden");
        replacementNoFields.classList.add("hidden");
        employeeName.required = true;
        hiringReason.required = false;
        hiringReason.value = "";
      } else if (value === "No") {
        replacementYesFields.classList.add("hidden");
        replacementNoFields.classList.remove("hidden");
        employeeName.required = false;
        employeeName.value = "";
        hiringReason.required = true;
      } else {
        replacementYesFields.classList.add("hidden");
        replacementNoFields.classList.add("hidden");
        employeeName.required = false;
        hiringReason.required = false;
      }
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(form);
      const data = {};
      
      // Build data object from form
      formData.forEach((value, key) => {
        data[key] = value;
      });

      // Handle conditional fields based on replacement value
      if (data.replacement === "Yes") {
        const empName = document.getElementById("employeeName").value;
        if (!empName || empName.trim() === "") {
          responseMsg.innerHTML = `<div class="error">❌ Please enter employee name for replacement</div>`;
          return;
        }
        data.employee_name = empName.trim();
        // Ensure hiring_reason is not included
        delete data.hiring_reason;
      } else if (data.replacement === "No") {
        const reason = document.getElementById("hiringReason").value;
        if (!reason || reason.trim() === "") {
          responseMsg.innerHTML = `<div class="error">❌ Please provide reason for hiring</div>`;
          return;
        }
        data.hiring_reason = reason.trim();
        // Ensure employee_name is not included
        delete data.employee_name;
      }

      console.log("Form data:", data);

      try {
        const res = await fetch("#", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });

        if (res.ok) {
          responseMsg.innerHTML = `<div class="success">✅ Form submitted successfully!</div>`;
          form.reset();
          document.getElementById("employeeName").value = "";
          document.getElementById("hiringReason").value = "";
          replacementYesFields.classList.add("hidden");
          replacementNoFields.classList.add("hidden");
        } else {
          responseMsg.innerHTML = `<div class="error">❌ Submission failed. Please try again.</div>`;
        }
      } catch (err) {
        responseMsg.innerHTML = `<div class="error">⚠️ Error: ${err.message}</div>`;
      }
    });
  </script>
</body>
</html>